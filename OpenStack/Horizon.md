#平台交互组件-Horizon##Horizon组件介绍:###Horizon的功能:   >Horizon是openstack整个应用的一个入口，提供一个web UI 的方式来访问、控制他们的计算、存储、和网络资源：如创建和启动实例、分配IP地址等。###Horizon特点： 1. 实例管理：创建、终止实例，查看终端日志，VNC连接，添加卷等;2. 访问与安全管理：创建安全群组，管理密匙对，设置浮动IP等;3. 偏好设定：对虚拟硬件模板可以进行不同偏好设定;4. 镜像管理：编辑或删除镜像;5. 查看服务目录;6. 管理用户、配额及项目用途;7. 用户管理：创建用户等;8. 卷管理：创建卷和快照;9. 对象存储处理：创建、删除容器和对象;10. 为项目下载环境变量;###Horizon的架构>主要由三个dashboard组成：用户dashboard、系统dashboard和设置dashboard:1. 用户dashboard:![imae](https://github.com/Becky-nuo/git-test/blob/master/images/Horizon-1.png)2. 系统dashboard:![image](https://github.com/Becky-nuo/git-test/blob/master/images/Horizon-2.png)3. 设置dashboard:![image](https://github.com/Becky-nuo/git-test/blob/master/images/Horizon-3.png)###Keystone、Dashboard二者与其它OpenStack部分的交互:![image](https://github.com/Becky-nuo/git-test/blob/master/images/Horizon-4.png)##安装horizon###在控制节点（controller）安装horizon组件：`yum install openstack-dashboard `###修改配置文件####备份原始配置文件：`cp /etc/openstack-dashboard/local_settings /etc/openstack-dashboard/local_settings.bak`	#####编辑配置文件：`vim /etc/openstack-dashboard/local_settings`>第188行修改主机名为“controller”：`OPENSTACK_HOST = "controller"`>第38行，设置“*”号，允许所有主机访问:` ALLOWED_HOSTS = ['*']`>第164行，缓存设置，加入以下内容：`SESSION_ENGINE = 'django.contrib.sessions.backends.cache'`>第167-168行加入：`'BACKEND': 'django.core.cache.backends.memcached.MemcachedCache','LOCATION': 'controller:11211'` >第189行为使用鉴权API的v3版本:`OPENSTACK_KEYSTONE_URL = 'http://%s:5000/v3' % OPENSTACK_HOST`>第75行，开启多域支持：`OPENSTACK_KEYSTONE_MULTIDOMAIN_SUPPORT = true`>第64行配置API版本：```OPENSTACK_API_VERSIONS = {	"identity" : 3 ,	"image"	: 2 ,	"volume" : 2 ,}```>第95行，设置默认域为“Default”：`OPENSTACK_KEYSTONE_DEFAULT_DOMAIN = 'Default'`>第190行，设置默认角色为“user”：`OPENSTACK_KEYSTONE_DEFAULT_ROLE = 'user'`>第464行，设置时区为“Asia/Shanghai”:`TIME_ZONE = "Asia/Shanghai"` >在以下配置文件加入：```	WSGIApplicationGroup %{GLOBAL}	vim /etc/httpd/conf.d/openstack-dashboard.conf	WSGIApplicationGroup %{GLOBAL}```	 ###重启服务:```	systemctl restart httpd.service	systemctl restart memcached.service```###登录Horizon:```	http://192.168.80.150/dashboard	#192.168.80.150为controller的IP地址 	Domain：default			用户：admin			密码：123456 ```##创建虚拟机###创建过程: 1. 创建虚拟网络 ;2. 创建m1.nano规格的主机（相等于定义虚拟机的硬件配置） 3. 生成一个密钥对（openstack的原理是不使用密码连接，而是使用密钥对进行连接） ;4. 增加安全组规则（用iptables做的安全组）; 5. 启动一个实例（启动虚拟机有三种类型：1.命令CLI 2.api 3.Dashboard）实际上Dashboard也是通过api进行操作 ;6. 虚拟网络分为提供者网络和私有网络，提供者网络就是跟主机在同一个网络里，私有网络自定义路由器等，跟主机不在一个网络;####创建初始化网络:>在控制节点运行环境员环境变量：`. /root/admin-openrc openstack network create selfservice1` >非特权用户通常不能为该命令提供额外的参数,该服务使用来自以下文件的信息自动选择参数：```cat /etc/neutron/plugins/ml2/ml2_conf.ini	[ml2]	tenant_network_types = vxlan	[ml2_type_vxlan]	vni_ranges = 1:1000```>创建的内部网络类型是由tenant_network_types中指定，为vxlan, 配置能指定内部网络类型，如flat，vlan，gre等####查看创建的网络：`openstack network list` ####为这个网络创建子网：```openstack subnet create --network selfservice1 \--dns-nameserver 114.114.114.114 --gateway 172.16.1.1 \--subnet-range 172.16.1.0/24 selfservice1-net1``` >查看子网：openstack subnet list>查看网络：ip netns ####创建虚拟机规格（flavor）类型：`openstack flavor create --id 0 --vcpus 1 --ram 64 --disk 1 temp1` >参数说明：```--id 			#模板id--vcpus		#cpu个数--ram			#内存大小--disk		#磁盘大小（单位G）temp1			#类型名称```  